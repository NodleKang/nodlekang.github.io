---
layout: single
title: "Slack"
date: 2024-11-28 09:00:00 +0900
categories: 
  - Slack
tag: 
  - slack
  - webhook
  - slackapi
toc: true
toc_label: 목차
toc_sticky: true
---

본 포스트는 Slack API로 메시지를 발송하기 위한 웹훅 설정에 대한 설명입니다.

# 포스트 작성 배경

어플리케이션을 개발하다면 시스템에서 이떤 이슈가 발생했을 때, 그 이슈를 바로 확인할 수 있도록 알림을 받길 원하는 경우가 있습니다. 

예전에는 주로 SMS 발신과 수신을 처리하는 시스템을 구축해서 사용했지만, 요즘에는 Slack이나 텔레그램 같은 메신저를 이용해서 알림을 받는 경우가 많습니다.

최근에는 Slack을 가장 많이 사용하는 것 같습니다.

그래서 Slack으로 메시지를 보내기 위해 웹훅을 설정하는 방법을 정리했습니다.

# 사전 준비 

1. 워크스페이스 생성
   - 처음 Slack에 가입하고 로그인하면 워크스페이스를 생성해야 합니다. 만약 이미 워크스페이스가 있다면 다음 단계로 진행합니다.
2. 채널 생성
   - Slack에서 메시지를 받을 채널을 생성합니다. 만약 이미 사용할 채널이 있다면 다음 단계로 진행합니다.

# 웹훅(Webhook) 수신 환경 구성

Slack에서 Incoming Webhooks라는 기능을 제공하는데, 이 기능을 이용하면 Slack에 메시지를 보낼 수 있습니다.API 사이트에서 앱을 생성한 후에 웹훅용 URL을 추가해야 합니다.

웹훅 URL로 메시지를 보내면 Slack API에서 생성한 앱이 그 메시지를 받아서 지정된 Slack 채널에 메시지를 송신합니다.

## 앱 생성

1. https://api.slack.com/apps 사이트에 Slack 계정으로 로그인 합니다.
2. 우측 상단에 보이면 "Create New App" 버튼을 클릭합니다.
3. 앱 생성 옵션을 선택하는 화면이 나오는데, 앱을 생성하는 것이니 "From Scratch" 옵션을 선택합니다.
   - "From a manifest" 옵션: manifest 파일을 사용하는 방식
   - "From a manifest" 옵션: UI를 사용하는 방식 
4. 앱 이름과 워크스페이스를 입력하는 화면이 나옵니다. <br> "App Name" 에 앱 이름을 쓰고, 앱이 사용할 워크스페이스를 선택합니다. <br> 그 후에 "Create App" 버튼을 클릭합니다.
5. 이제 새 앱이 생성되었을 겁니다. 만약 화면에서 앱이 바로 보이지 않으면 우측 상단에 있는 "Your Apps"를 클릭하면 확인할 수 있습니다.

## Incoming Webhook URL 생성

Slack에서 Incoming Webhook 은 Slack이 정한 포멧에 일치하는 데이터를 보내주면, 지정된 채널에 메시지를 보내주는 기능입니다. 

1. https://api.slack.com/apps 사이트에 Slack 계정으로 로그인 합니다.
2. 우측 상단에 있는 "Your Apps"를 클릭해서 보이는 앱 목록에서 원하는 앱을 선택해서 앱 설정 화면으로 이동합니다.
3. 좌측 사이드바 메뉴들 중에 "Incoming Webhooks" 메뉴를 선택합니다.
4. "Incoming Webhooks" 메뉴 화면에서 다음과 같은 작업을 합니다.
   - Activate Incoming Webhooks 설정을 "On"으로 변경합니다.
   - "Add New Webhook to Workspace" 버튼을 클릭해서 웹훅을 추가합니다. <br> 웹훅이 추가되면 같은 화면에서 "Webhook URL"이 확인됩니다.
5. 예전에는 메시지를 수신할 Slack 채널에서 생성한 앱을 초대했어야 했습니다. <br> 하지만 2024년 11월 현재는 앱을 추가하면 즉시 Slack 채널에 생성한 앱이 추가됩니다.    
6. 참고로, 웹훅에 관련된 권한을 설정하고 싶다면 좌측 사이드바 메뉴들 중에 "OAuth & Permissions" 메뉴에서 설정할 수 있습니다.

## 주의사항

Slack에서 Incoming Webhook을 사용하는 방법에는 앞에서 설명한 방법 외에 다른 방법도 있습니다.

바로 메시지를 수신할 Slack 채널의 "채널 세부정보"에 "통합" 메뉴에서 "앱"을 추가하는 방법입니다.

그런데, 그런 방식은 문제가 있습니다.

해당 웹훅을 만든 사용자의 상태가 Disable이 되면 웹훅URL이 비활성화 되어 사용할 수 있게 된다는 것 입니다.

그래서 이 포스트에서는 그 방법에 대해서 설명하지 않습니다.

# 참고

## Slack 관련 개념들

Slack은 팀 단위로 채널을 만들어서 팀원들과 소통할 수 있는 메신저입니다.

Slack에는 다음과 같은 주요 개념들이 있습니다.

- 워크스페이스
  - 팀원들이 함께 소통하고 협력할 수 있는 채널로 구성된 공간입니다.
- 채널
  - 팀원들이 "특정 프로젝트", "특정 주제" 등을 정하고 관련된 대화를 나누고 협업할 수 있는 전용 공간입니다.
  - 공개, 비공개로 설정할 수 있습니다.
- 스레드
  - 특정 메시지에 대한 답변이나 논의를 묶어서 관리할 수 있는 기능으로, 하나의 주제에 대해 체계적으로 대화할 수 있도록 돕습니다.
- DM
  - 개인 간 또는 소그룹간에 직접 대화입니다.
- Slack API
  - 개발자들이 Slack 플랫폼과 상호작용할 수 있게 해주는 도구 모음입니다.
 
<div class="notice" markdown="1">
**Slack 개념 이해를 돕기 위해 예**

우리 회사에서는 "MyCompany" **워크스페이스**가 있습니다.
회사 안에는 인사팀을 위한 "HR" **채널**, 개발팀을 위한 "DEV" **채널** 등이 있습니다.
개발팀에 속한 팀원이 "메신저 기능 개발에 대해서 협의해봐요." 라는 메시지를 등록하고, 
다른 팀원들이 그 메시지 하위에 답글 등으로 관련된 의견이나 질문을 추가하면 그게 **스레드**가 됩니다.  
</div>

## 웹훅(Webhook)

웹훅(Webhook)은 특정 이벤트가 발생했을 때 미리 지정된 URL로 자동으로 HTTP 요청을 보내는 기능입니다. 

주요 특징은 다음과 같습니다:

1. 역방향 API라고도 불리며, 서버에서 클라이언트로 데이터를 전송합니다.
2. 실시간 데이터 전송이 가능하여 이벤트 발생 즉시 처리할 수 있습니다.
3. 다른 시스템과의 통합이 간단하고 유연합니다.

웹훅의 작동 원리는 다음과 같습니다:

1. 특정 이벤트를 트리거로 지정합니다.
2. 이벤트 발생 시 데이터를 전송할 URL을 설정합니다.
3. 이벤트 발생 시 지정된 URL로 HTTP 요청을 자동으로 전송합니다.
4. 수신 서버에서 요청을 받아 필요한 처리를 수행합니다.

웹훅은 실시간 알림 같은 상황에서 활용될 수 있습니다.
